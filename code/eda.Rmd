---
title: "Exploratory Data Analysis"
author: "Orfeas Gkourlias"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#Bioconductor packages
library("annotate")
library("hgu133plus2.db")
```

\newpage

\section{Introduction}
The aim of this project is to find links between certain gene expressions and familial Alzheimer's disease, using machine learning. To be more specific for the sake of data analysis: The mutation being observed is a presenilin 2 mutation, using patient-specific induced pluripotent stem cells (iPSC) to facilitate expression of the mutant type. Four different expression profiles were collected, using the Affymetrix Human Genome U133 Plus 2.0 Array. When looking at the names of columns, genes and differing values of expression, it's important to consider those are are all Affymetrix standards, which may need to be converted to further down the line. For example: Converting the gene IDs to ensembl IDs.
\newpage   

\section{Initial Data and Variables}
Let's first take a look at the provided .csv file, it's structure and first entries.

```{r}
raw.df = read.csv("../data/GSE28379.csv")
head(raw.df, 5)
```
## ID_Ref.
This column indicates the probe ID's, as sequenced by the  Affymetrix Human Genome U133 Plus 2.0 Array. This is athe result of the sequencing technique. These are probe ID's, which don't represent a lot by themselves. They can, however, be used to find the ensembl ID's and gene symbols, which will be attempted below with Bioconductor:

```{r}
genes <- select(hgu133plus2.db, c(raw.df[,1]), c("SYMBOL","ENTREZID", "GENENAME", "ONTOLOGY", "PATH"))
na.list <- genes[is.na(genes$SYMBOL),] # Storing the genes which were not detected for whatever reason.
colnames(genes)[1] <- "ID_REF" # Renaming  the column so the following merge works.
main <- merge(raw.df, genes, by=c("ID_REF")) # Merging the two dataframes together into a new one.
main <- main[!(main$ID_REF == "!series_matrix_table_end"),] # Removing an indicator row.
head(main[,c(1,10,11,12)], 5)
```
To summarize what has just been done: A bioconductor database was used to
find the corresponding gene for every probe. It's important to note that for yet unknown reasons
some probes were not recognized. The proper database was used, as can be seen by the database name.

## GSM
The GSM columns indicate the different samples used in the paper this data is derived from.
The values under these columns represent sequencing concentration, which is the result of a normalisation algorithm called MAS5.0. This algorithm is also developed by Affymetrix. These values are also not log transformed. A dedicated column was made for that.

The first two samples, GSM701542 and GSM701543 are iPSC sequences derived from Sparadic Parkinson's disease patients. The latter two, 
GSM701544 and GSM701545 are iPSC sequences from familial Alzheimer's dis    ease (FAD) patients. The referenced paper aimed to compare
the two conditions and their gene expressions.

## No mutation & Mutation
The first column, no mutation, signifies the average of the first two non mutated parkinson's samples.
The second column, mutation, shows the average of the two FAD mutant type samples.

## Log2 Fold Change
These are subtracted 2log fold change values, showing which of the two averages are up regulated and down regulated.
In case of a positive number, the mutation type samples are up regulated and the non-mutant types are down regulated.
The reverse is true in case of a negative number.

## Fold change
The ratio between the mutation and no mutation values. Mutation being divided by no mutation in this case.
\newpage 

# Data variance
The original paper aimed to compare two groups and their expressions. By looking at the calculated Log2FC data, it'll be possible to see how much the two groups differ. Let's first look at the most significant differently expressing genes.

```{r}
main <- main[order(main$log.2.fold.change),] # Reordering the DF by log2FC
head(main[,c(10,6,7,8)], 10) #Showing the 10 most significant down regulated genes
tail(main[,c(10,6,7,8)], 10) #Showing the 10 most significant up regulated genes
```
\newpage
By taking a glance at the tables above, it seems that down regulation consists of more extreme values than up regulation. While this may be telling of how expression is affected by the mutation in general, it's not enough on its own to draw any conclusions yet. Let's further explore the log2fc values by creating a boxplot.     

```{r}
boxplot(main$log.2.fold.change, horizontal = TRUE, xlab = "Log2FC", title = "Boxplot of Log2FC")
```

As can be seen from the boxplot, there appears to be great variance in the log2FC values.
This may be further examined by looking at a summary.

```{r}
summary(main$log.2.fold.change)
```
Judging by the boxplot and summary table, the genes seem to be mostly down regulated.

# Relations
Since the data provided is that of solely DEG's, there will not be any variables
that affect each other, besides the obvious calculation of fold changes and means.
That being said: There could be a connection between up/down regulation of certain
genetic regions. Taking RPS4Y1, a gene encoding for a ribosomal sub unit,
as an example: Could there be a trend in the mutation affecting down/up regulation
of specifically ribosomal genes? Questions like these are not suited for EDA, but 
the addition of gene symbols, KEGG pathway, ontology and entrezID's columns in this document 
will help in answering such questions, which will eventually mean answering the research question.

Plotting the different KEGG IDs and ontological vlsddrd can however offer insight into
which pathways and classes are most prevelant.

```{r}
barplot(table(main$ONTOLOGY), xlab = "Ontological Class", ylab = "Occurences")
```
The differing classes appear to be close in the amount of occurrences. It may be
possible to find a relationship when looking at the Log2FC values for every different class.

```{r}
BP <- subset(main, ONTOLOGY == "BP")
CC <- subset(main, ONTOLOGY == "CC")
MF <- subset(main, ONTOLOGY == "MF")

summary(BP$log.2.fold.change)
summary(CC$log.2.fold.change)
summary(MF$log.2.fold.change)

boxplot(BP$log.2.fold.change, CC$log.2.fold.change, MF$log.2.fold.change)
```
Both the summaries and boxplots are very similar for every clasification.
At first glance this indicates that the classes are not a detriment in
the fold change values of genes.